import{j as e}from"./ui-vendor-yLFRes2f.js";import{u as _e,d as Be,r as h}from"./react-vendor-DWSrZqKN.js";import{a as L,m as Me}from"./utils-vendor-DFcOAB1P.js";import{k as Ve,a as Ye,c,b as i,S as Se,aT as ce,a7 as Oe,N as V,a3 as We,a4 as He,a5 as K,C as Qe,F as T,aq as X,a$ as f,au as Z,ak as Y,aF as D,al as Ge,am as Je,aD as Ke,an as Xe,b0 as Ze,ao as O,D as I,b1 as de,ar as me,as as xe,at as $e,aw as R,Y as he,a0 as ue,a1 as pe,a2 as ge,ae as Ue,aa as Pe,av as Re,af as De,ag as qe,ah as es,ai as ss,aj as q,b2 as je}from"./index-CqPKG3Vx.js";import{C as ls}from"./CarouselPreview-BDcPBU_v.js";import{P as W}from"./pen-line-3DgLAQwF.js";import{S as Ae}from"./share-2-CeaL_0hT.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=Ve("FileImage",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["circle",{cx:"10",cy:"12",r:"2",key:"737tya"}],["path",{d:"m20 17-1.296-1.296a2.41 2.41 0 0 0-3.408 0L9 22",key:"wt3hpn"}]]),E="https://api.brandout.ai/api",xs=()=>{const C=_e(),_=Be(),{user:as,token:u}=Ye(),[ee,be]=h.useState([]),[se,B]=h.useState([]),[F,fe]=h.useState(!0),[H,Ne]=h.useState(""),[n,A]=h.useState(null),[a,S]=h.useState(null),[ts,le]=h.useState(0),[k,Le]=h.useState("all"),[N,Ie]=h.useState(""),[p,$]=h.useState(!1),[m,g]=h.useState({}),[ae,te]=h.useState(!1),[x,ve]=h.useState(null),[ze,re]=h.useState(!1),Q=h.useCallback(async()=>{try{fe(!0);const s={headers:{Authorization:`Bearer ${u}`}},l=await L.get(`${E}/carousels`,s);be(l.data),Ne("")}catch(s){console.error("Error fetching carousels:",s),Ne("Failed to fetch carousels. Please try again later."),c.error("Failed to fetch carousels")}finally{fe(!1)}},[u]),ne=h.useCallback(async()=>{if(u)try{const s={headers:{Authorization:`Bearer ${u}`}},l=await L.get(`${E}/carousels/user/requests`,s);l.data&&l.data.success&&Array.isArray(l.data.data)?B(l.data.data):l.data&&Array.isArray(l.data)?B(l.data):(console.error("Unexpected response format:",l.data),B([]))}catch(s){console.error("Error fetching carousel requests:",s),c.error("Failed to fetch carousel requests")}},[u]);h.useEffect(()=>{u&&(Q(),ne())},[u,Q,ne]),h.useEffect(()=>{var s;(s=_.state)!=null&&s.fromEditor&&(c.success("Carousel saved successfully!"),u&&Q().then(()=>{var l;if((l=_.state)!=null&&l.carouselId){const r=ee.find(t=>t._id===_.state.carouselId);r&&A(r)}}),C(_.pathname,{replace:!0,state:{}}))},[_,C,u,Q,ee]);const ie=ee.filter(s=>k==="all"?!0:s.status===k).filter(s=>N.trim()?s.title.toLowerCase().includes(N.toLowerCase())||s.description.toLowerCase().includes(N.toLowerCase()):!0),we=s=>{C(`/dashboard/post?carouselId=${s._id}&type=carousel`),c.success(`Creating new post with "${s.title}" carousel`)},v=s=>{const l={year:"numeric",month:"short",day:"numeric"};return new Date(s).toLocaleDateString("en-US",l)},G=async(s,l)=>{if(!s){c.error("Invalid file URL");return}try{const t=await(await fetch(s)).blob(),d=window.URL.createObjectURL(t),o=document.createElement("a");o.href=d,o.download=l,document.body.appendChild(o),o.click(),document.body.removeChild(o),window.URL.revokeObjectURL(d)}catch(r){console.error("Download error:",r),c.error("Failed to download file")}},ye=async(s,l)=>{try{const r={headers:{Authorization:`Bearer ${u}`},responseType:"blob"};c.info("Preparing PDF for download...");const t=await L.get(`${E}/carousels/${s}/download`,r),d=new Blob([t.data],{type:"application/pdf"}),o=window.URL.createObjectURL(d),y=document.createElement("a");y.href=o,y.download=`${l.replace(/[^a-z0-9]/gi,"-").toLowerCase()}.pdf`,document.body.appendChild(y),y.click(),document.body.removeChild(y),window.URL.revokeObjectURL(o),c.success("PDF downloaded successfully")}catch(r){console.error("Error downloading PDF:",r),c.error("Failed to download PDF")}},Ce=async s=>{const l=s.completedFiles||[];if(l.length===0){c.error("No completed files available to download");return}if(c.info(`Preparing ${l.length} files for download...`),l.length===1){const d=l[0];if(!d||!d.url){c.error("Invalid file");return}await G(U(d.url),d.originalName||w(d.url));return}let r=0;const t=async d=>{if(d>=l.length){c.success(`All ${l.length} files downloaded successfully`);return}const o=l[d];if(!o||!o.url){console.error(`Invalid file at index ${d}`),setTimeout(()=>t(d+1),500);return}await G(U(o.url),o.originalName||w(o.url)),r++,c.info(`Downloading file ${r} of ${l.length}`),setTimeout(()=>t(d+1),1500)};await t(0)},Ee=async s=>{try{const l={headers:{Authorization:`Bearer ${u}`}};await L.delete(`${E}/carousels/${s}`,l),be(r=>r.filter(t=>t._id!==s)),n&&n._id===s&&A(null),c.success("Carousel deleted successfully")}catch(l){console.error("Error deleting carousel:",l),c.error("Failed to delete carousel")}},M=({status:s})=>{switch(s){case"completed":return e.jsx(R,{className:"bg-white text-green-600 border border-green-300 hover:bg-green-50",children:"Completed"});case"pending":return e.jsx(R,{className:"bg-white text-yellow-600 border border-yellow-300 hover:bg-yellow-50",children:"Pending"});case"in_progress":return e.jsx(R,{className:"bg-white text-blue-600 border border-blue-300 hover:bg-blue-50",children:"In Progress"});case"rejected":return e.jsx(R,{className:"bg-white text-red-600 border border-red-300 hover:bg-red-50",children:"Rejected"});default:return e.jsx(R,{className:"bg-white text-gray-600 border border-gray-300",children:"Unknown"})}},j=s=>s?/\.(jpg|jpeg|png|gif|webp|svg)$/i.test(s)||s.includes("/image/upload/")||s.includes("cloudinary")&&s.includes("/image/"):!1,w=s=>{if(!s)return"file";const l=s.split("/"),t=l[l.length-1].split("?")[0];if(s.includes("cloudinary")||s.includes("res.cloudinary.com")){const d=t.split(".");if(d.length>1)return d[0].substring(0,15)+"."+d[d.length-1]}return t||"file"},U=s=>{if(!s)return"";if(s.startsWith("http"))return s;const l="https://api.brandout.ai/api",r=l.endsWith("/api")?l.substring(0,l.length-4):l;if(s.startsWith("/uploads/")||s.startsWith("uploads/"))return s.startsWith("/")?`${r}${s}`:`${r}/${s}`;if(s.includes("files-")){const t=s.split("/").pop();return`${r}/uploads/${t}`}return`${l}/${s.startsWith("/")?s.substring(1):s}`},P=se.filter(s=>k==="all"?!0:s.status===k).filter(s=>N.trim()?s.title.toLowerCase().includes(N.toLowerCase())||(s.description||"").toLowerCase().includes(N.toLowerCase()):!0),oe=(s,l=!1)=>{S(s),g({title:s.title,description:s.description,carouselType:s.carouselType,content:s.content,videoId:s.videoId,videoTitle:s.videoTitle,youtubeUrl:s.youtubeUrl,filesToDelete:[]}),$(l)},ke=async(s,l)=>{var r;try{if(ae)return;te(!0);const t=se.find(b=>b._id===s||b.id===s);if(t&&t.resendCount&&t.resendCount>=1){c.error("This request has already been resent once and cannot be resent again"),te(!1);return}const d={headers:{Authorization:`Bearer ${u}`,"Content-Type":"multipart/form-data"}},o=new FormData;l?(l.title&&o.append("title",l.title),l.description&&o.append("description",l.description),l.carouselType&&o.append("carouselType",l.carouselType),l.content&&o.append("content",l.content),l.videoId&&o.append("videoId",l.videoId),l.videoTitle&&o.append("videoTitle",l.videoTitle),l.youtubeUrl&&o.append("youtubeUrl",l.youtubeUrl),l.filesToDelete&&l.filesToDelete.length>0&&o.append("filesToDelete",JSON.stringify(l.filesToDelete)),l.newFiles&&l.newFiles.length>0&&l.newFiles.forEach(b=>{b&&b.name&&b.size&&b.type&&o.append("files",b)})):o.append("resend","true");const y=await L.post(`${E}/carousels/requests/${s}/resend`,o,d);y.data&&y.data.success?(c.success("Request resubmitted successfully"),$(!1),B(b=>b.map(J=>J._id===s||J.id===s?{...J,status:"pending",resendCount:1,updatedAt:new Date().toISOString(),...l!=null&&l.title?{title:l.title}:{},...l!=null&&l.description?{description:l.description}:{},...l!=null&&l.carouselType?{carouselType:l.carouselType}:{},...l!=null&&l.content?{content:l.content}:{},...l!=null&&l.videoId?{videoId:l.videoId}:{},...l!=null&&l.videoTitle?{videoTitle:l.videoTitle}:{},...l!=null&&l.youtubeUrl?{youtubeUrl:l.youtubeUrl}:{}}:J)),ne(),S(null)):c.error(((r=y.data)==null?void 0:r.message)||"Failed to resubmit request")}catch(t){console.error("Error resubmitting request:",t),t.response&&t.response.data&&t.response.data.message?c.error(t.response.data.message):c.error("Failed to resubmit request. Please try again later.")}finally{te(!1)}},Te=async s=>{var l,r;if(u)try{const t={headers:{Authorization:`Bearer ${u}`}};if(!window.confirm("Are you sure you want to delete this request? This action cannot be undone."))return;await L.delete(`${E}/carousels/requests/${s}`,t),B(se.filter(d=>d.id!==s&&d._id!==s)),S(null),c.success("Carousel request deleted successfully")}catch(t){console.error("Error deleting carousel request:",t),c.error(((r=(l=t.response)==null?void 0:l.data)==null?void 0:r.message)||"Failed to delete carousel request")}},Fe=s=>{if(!s||!s.url){c.error("Invalid file");return}const l=U(s.url),r=s.originalName||w(s.url),t=j(s.url)?"image":"document";ve({url:l,type:t,name:r}),re(!0)};return e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold mb-2",children:"My Carousels"}),e.jsx("p",{className:"text-black",children:"Manage and create LinkedIn carousel posts"})]}),e.jsxs("div",{className:"mt-4 sm:mt-0 flex flex-col sm:flex-row gap-3",children:[e.jsxs(i,{onClick:()=>C("/dashboard/request-carousel"),className:"gap-2",children:[e.jsx(Se,{className:"h-4 w-4"}),"Request Carousel"]}),e.jsxs(i,{variant:"outline",onClick:()=>C("/dashboard/templates"),className:"gap-2",children:[e.jsx(ce,{className:"h-4 w-4"}),"Browse Templates"]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Oe,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(V,{placeholder:"Search carousels...",className:"pl-10 border-2 focus:border-primary",value:N,onChange:s=>Ie(s.target.value)})]}),e.jsx(We,{value:k,onValueChange:Le,className:"w-full sm:w-auto",children:e.jsxs(He,{className:"w-full grid grid-cols-4 sm:w-auto",children:[e.jsx(K,{value:"all",children:"All"}),e.jsx(K,{value:"completed",children:"Completed"}),e.jsx(K,{value:"pending",children:"Pending"}),e.jsx(K,{value:"rejected",children:"Rejected"})]})})]}),F&&e.jsx("div",{className:"flex justify-center items-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-blue-500"})}),H&&!F&&e.jsxs("div",{className:"bg-red-50 border-2 border-red-200 rounded-lg p-6 text-center mb-8",children:[e.jsx(Qe,{className:"h-10 w-10 text-red-500 mx-auto mb-3"}),e.jsx("h3",{className:"text-lg font-medium mb-2 text-red-600",children:"Something went wrong"}),e.jsx("p",{className:"text-red-600 mb-4",children:H}),e.jsx(i,{variant:"outline",onClick:()=>window.location.reload(),className:"border-red-300 text-red-600 hover:bg-red-50",children:"Try Again"})]}),!F&&!H&&ie.length===0&&P.length===0&&e.jsxs("div",{className:"bg-white border-2 border-blue-200 rounded-lg p-8 text-center mb-8",children:[e.jsx(T,{className:"h-12 w-12 text-blue-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No carousels found"}),e.jsx("p",{className:"text-black mb-6",children:N?`No carousels match your search for "${N}"`:k==="pending"?"You don't have any pending carousel requests":k==="rejected"?"You don't have any rejected carousel requests":k==="completed"?"You don't have any completed carousels yet":"You don't have any carousels yet"}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-center gap-3",children:[e.jsxs(i,{onClick:()=>C("/dashboard/request-carousel"),className:"gap-2",children:[e.jsx(Se,{className:"h-4 w-4"}),"Request New Carousel"]}),e.jsxs(i,{variant:"outline",onClick:()=>C("/dashboard/templates"),className:"gap-2",children:[e.jsx(ce,{className:"h-4 w-4"}),"Browse Templates"]})]})]}),!F&&!H&&ie.length>0&&e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 mb-8",children:ie.map(s=>e.jsx(Me.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},children:e.jsxs(X,{className:"h-full flex flex-col overflow-hidden border-2 hover:border-primary hover:shadow-md transition-all duration-200",children:[e.jsxs("div",{className:"aspect-video bg-white border-b relative cursor-pointer",onClick:()=>{A(s),le(0)},children:[e.jsx("div",{className:"w-full h-full bg-gradient-to-br from-blue-50 to-white flex items-center justify-center",children:s.thumbnailUrl?e.jsx("img",{src:s.thumbnailUrl,alt:s.title,className:"w-full h-full object-contain"}):e.jsxs("div",{className:"text-center p-4",children:[e.jsx("h3",{className:"text-lg font-bold text-black mb-1",children:s.title}),e.jsxs("p",{className:"text-xs text-black",children:[s.slideCount," slides"]})]})}),e.jsx("div",{className:"absolute top-2 left-2",children:e.jsx(M,{status:s.status})}),e.jsx("div",{className:"absolute top-2 right-2 flex gap-2",children:e.jsx("button",{className:"p-1.5 rounded-full bg-black/70 hover:bg-black/90 text-white transition-colors",onClick:l=>{l.stopPropagation(),A(s),le(0)},children:e.jsx(f,{size:14})})})]}),e.jsx(Z,{className:"py-4 flex-grow",children:e.jsx("div",{className:"flex justify-between items-start mb-2",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-black line-clamp-2 mb-1",children:s.description}),e.jsxs("div",{className:"flex items-center text-xs text-black gap-3",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx(Y,{className:"h-3 w-3 mr-1 text-blue-500"}),v(s.createdAt)]}),s.status==="completed"&&s.views&&e.jsxs("span",{className:"flex items-center",children:[e.jsx(f,{className:"h-3 w-3 mr-1 text-green-500"}),s.views," views"]})]})]})})}),e.jsxs(D,{className:"pt-0 pb-4 flex gap-2",children:[e.jsxs(i,{className:"flex-1",onClick:()=>we(s),children:[e.jsx(W,{className:"h-4 w-4 mr-2"}),"Create Post"]}),e.jsxs(Ge,{children:[e.jsx(Je,{asChild:!0,children:e.jsx(i,{variant:"outline",size:"icon",className:"border-blue-200",children:e.jsx(Ke,{className:"h-4 w-4"})})}),e.jsxs(Xe,{align:"end",children:[e.jsx(Ze,{children:"Actions"}),e.jsxs(O,{className:"flex items-center gap-2",onClick:()=>{A(s),le(0)},children:[e.jsx(f,{className:"h-4 w-4"}),e.jsx("span",{children:"Preview"})]}),e.jsxs(O,{className:"flex items-center gap-2",onClick:()=>C(`/dashboard/post?carouselId=${s._id}&type=carousel`),children:[e.jsx(W,{className:"h-4 w-4"}),e.jsx("span",{children:"Create Post"})]}),e.jsxs(O,{className:"flex items-center gap-2",onClick:()=>{navigator.clipboard.writeText(`${window.location.origin}/carousel/${s._id}`),c.success("Carousel link copied to clipboard")},children:[e.jsx(Ae,{className:"h-4 w-4"}),e.jsx("span",{children:"Share"})]}),e.jsxs(O,{className:"flex items-center gap-2",onClick:()=>ye(s._id,s.title),children:[e.jsx(I,{className:"h-4 w-4"}),e.jsx("span",{children:"Download PDF"})]}),e.jsxs(O,{className:"flex items-center gap-2",onClick:()=>{window.confirm(`Are you sure you want to delete "${s.title}"?`)&&Ee(s._id)},children:[e.jsx(de,{className:"h-4 w-4"}),e.jsx("span",{children:"Delete"})]})]})]})]})]})},s._id))}),!F&&P.filter(s=>s.status==="pending"||s.status==="in_progress").length>0&&e.jsxs("div",{className:"mt-8 mb-8",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Pending Carousel Requests"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:P.filter(s=>s.status==="pending"||s.status==="in_progress").map(s=>e.jsxs(X,{className:"overflow-hidden hover:shadow-md transition-shadow",children:[e.jsxs(me,{className:"pb-2",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx(xe,{className:"text-lg",children:s.title}),e.jsx(M,{status:s.status})]}),e.jsx($e,{className:"line-clamp-2",children:s.description||"No description"})]}),e.jsxs(Z,{className:"pb-2",children:[e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-sm font-medium mb-2",children:"Your Uploaded Files:"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[(s.files||[]).slice(0,4).map((l,r)=>e.jsxs("div",{className:"border rounded p-2 flex items-center",children:[j(l.url)?e.jsx(z,{className:"h-4 w-4 mr-2 text-blue-500"}):e.jsx(T,{className:"h-4 w-4 mr-2 text-orange-500"}),e.jsx("span",{className:"text-xs truncate",children:l.originalName||w(l.url)})]},r)),(s.files||[]).length>4&&e.jsx("div",{className:"border rounded p-2 flex items-center justify-center",children:e.jsxs("span",{className:"text-xs text-gray-500",children:["+",(s.files||[]).length-4," more"]})}),(s.files||[]).length===0&&e.jsx("div",{className:"col-span-2 border rounded p-2 text-center",children:e.jsx("span",{className:"text-xs text-gray-500",children:"No files available"})})]})]}),s.carouselType&&e.jsx("div",{className:"mt-4",children:e.jsxs("span",{className:"text-xs bg-blue-50 text-blue-700 px-2 py-1 rounded-full",children:[s.carouselType," carousel"]})})]}),e.jsxs(D,{className:"pt-0 flex justify-between",children:[e.jsxs("div",{className:"text-xs text-gray-500 flex items-center",children:[e.jsx(Y,{className:"h-3 w-3 mr-1"}),s.resendCount&&s.resendCount>=1?v(s.updatedAt):v(s.createdAt)]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-2 justify-end",children:[e.jsxs(i,{variant:"outline",size:"sm",onClick:()=>oe(s),children:[e.jsx(f,{className:"h-4 w-4 mr-1"}),"View"]}),e.jsx(i,{variant:"ghost",size:"icon",className:"h-8 w-8 rounded-full text-red-600 hover:text-red-700 hover:bg-red-50",onClick:()=>Te(s.id||s._id),children:e.jsx(de,{className:"h-4 w-4"})})]})]})]},s._id||s.id))})]}),!F&&P.filter(s=>s.status==="completed").length>0&&e.jsxs("div",{className:"mt-8 mb-8",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Completed Carousels"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:P.filter(s=>s.status==="completed").map(s=>e.jsxs(X,{className:"overflow-hidden hover:shadow-md transition-shadow",children:[e.jsx(me,{className:"pb-2",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx(xe,{className:"text-lg",children:s.title}),e.jsx(M,{status:s.status})]})}),e.jsx(Z,{className:"pb-2",children:e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-sm font-medium mb-2",children:"Delivered Files:"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[(s.completedFiles||[]).map((l,r)=>e.jsxs("div",{className:"border rounded p-3 flex flex-col h-[120px]",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[l&&l.url&&j(l.url)?e.jsx(z,{className:"h-4 w-4 mr-2 text-blue-500"}):e.jsx(T,{className:"h-4 w-4 mr-2 text-orange-500"}),e.jsx("span",{className:"text-sm truncate font-medium",children:(l==null?void 0:l.originalName)||w(l==null?void 0:l.url)})]}),l&&l.url&&j(l.url)&&e.jsx("div",{className:"flex-1 bg-gray-100 rounded p-1 flex items-center justify-center overflow-hidden",children:e.jsx("img",{src:U(l.url),alt:l.originalName||"Preview",className:"max-h-full max-w-full object-contain"})}),l&&l.url&&!j(l.url)&&e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsx(T,{className:"h-12 w-12 text-gray-300"})})]},r)),(s.completedFiles||[]).length>4&&e.jsx("div",{className:"border rounded p-2 flex items-center justify-center bg-green-50 border-green-100 h-[120px]",children:e.jsxs("span",{className:"text-xs text-green-700",children:["+",(s.completedFiles||[]).length-4," more"]})}),(s.completedFiles||[]).length===0&&e.jsx("div",{className:"col-span-2 border rounded p-2 text-center h-[120px] flex items-center justify-center",children:e.jsx("span",{className:"text-xs text-gray-500",children:"No delivered files available"})})]})]})}),e.jsx(D,{className:"pt-0",children:e.jsxs("div",{className:"w-full flex items-center justify-between",children:[e.jsxs("div",{className:"text-xs text-gray-500 flex items-center",children:[e.jsx(Y,{className:"h-3 w-3 mr-1"}),v(s.updatedAt)]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(i,{variant:"ghost",size:"icon",className:"h-8 w-8 rounded-full text-blue-600 hover:text-blue-800 hover:bg-blue-50",onClick:()=>oe(s),title:"View Details",children:e.jsx(f,{className:"h-4 w-4"})}),e.jsx(i,{variant:"ghost",size:"icon",className:"h-8 w-8 rounded-full text-green-600 hover:text-green-800 hover:bg-green-50",onClick:()=>Ce(s),title:"Download All",children:e.jsx(I,{className:"h-4 w-4"})})]})]})})]},s._id||s.id))})]}),!F&&P.filter(s=>s.status==="rejected").length>0&&e.jsxs("div",{className:"mt-8 mb-8",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Rejected Requests"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:P.filter(s=>s.status==="rejected").map(s=>e.jsxs(X,{className:"overflow-hidden hover:shadow-md transition-shadow border-2 border-red-100",children:[e.jsxs(me,{className:"pb-2",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx(xe,{className:"text-lg",children:s.title}),e.jsx(R,{className:"bg-red-500 hover:bg-red-600",children:"Rejected"})]}),e.jsx($e,{className:"line-clamp-2",children:s.description||"No description"})]}),e.jsxs(Z,{className:"pb-2",children:[e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-sm font-medium mb-2",children:"Your Uploaded Files:"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[(s.files||[]).slice(0,4).map((l,r)=>e.jsxs("div",{className:"border rounded p-2 flex items-center",children:[j(l.url)?e.jsx(z,{className:"h-4 w-4 mr-2 text-blue-500"}):e.jsx(T,{className:"h-4 w-4 mr-2 text-orange-500"}),e.jsx("span",{className:"text-xs truncate",children:l.originalName||w(l.url)})]},r)),(s.files||[]).length>4&&e.jsx("div",{className:"border rounded p-2 flex items-center justify-center",children:e.jsxs("span",{className:"text-xs text-gray-500",children:["+",(s.files||[]).length-4," more"]})}),(s.files||[]).length===0&&e.jsx("div",{className:"col-span-2 border rounded p-2 text-center",children:e.jsx("span",{className:"text-xs text-gray-500",children:"No files available"})})]})]}),s.adminNotes&&e.jsxs("div",{className:"mt-4 text-sm bg-red-50 p-2 rounded",children:[e.jsx("p",{className:"font-medium text-red-700",children:"Reason for rejection:"}),e.jsx("p",{className:"text-gray-700",children:s.adminNotes})]})]}),e.jsxs(D,{className:"pt-0 flex justify-between",children:[e.jsxs("div",{className:"text-xs text-gray-500 flex items-center",children:[e.jsx(Y,{className:"h-3 w-3 mr-1"}),v(s.updatedAt)]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(i,{variant:"outline",size:"sm",onClick:()=>oe(s),children:[e.jsx(f,{className:"h-4 w-4 mr-1"}),"View"]}),e.jsx(i,{variant:"ghost",size:"icon",className:"h-8 w-8 rounded-full text-red-600 hover:text-red-700 hover:bg-red-50",onClick:()=>Te(s.id||s._id),children:e.jsx(de,{className:"h-4 w-4"})}),s.status==="rejected"&&e.jsxs(i,{size:"sm",variant:"outline",className:`${s.resendCount&&s.resendCount>=1?"text-gray-500 border-gray-300 cursor-not-allowed":"text-orange-600 border-orange-300 hover:bg-orange-50 hover:text-orange-700"}`,onClick:()=>{if(s.resendCount&&s.resendCount>=1){c.error("This request has already been resent once and cannot be edited or resent again");return}S(s),$(!0)},disabled:s.resendCount&&s.resendCount>=1,children:[e.jsx(W,{className:"h-4 w-4 mr-1"}),"Edit"]})]})]})]},s._id||s.id))})]}),e.jsx(he,{open:!!n,onOpenChange:s=>!s&&A(null),children:e.jsxs(ue,{className:"max-w-2xl w-[90vw]","aria-labelledby":"carousel-dialog-title","aria-describedby":"carousel-dialog-description",children:[e.jsxs(pe,{children:[e.jsxs(ge,{className:"flex items-center justify-between text-base",id:"carousel-dialog-title",children:[e.jsx("span",{children:n==null?void 0:n.title}),e.jsx("div",{children:e.jsx(M,{status:(n==null?void 0:n.status)||"pending"})})]}),e.jsx(Ue,{className:"text-sm",id:"carousel-dialog-description",children:n==null?void 0:n.description})]}),e.jsx("div",{className:"relative my-3",children:n&&e.jsx(ls,{slides:n.slides.map((s,l)=>({id:`slide-${l}`,content:s.content||"",imageUrl:s.imageUrl})),variant:"basic"})}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3 mb-3",children:[e.jsxs("div",{className:"bg-white border rounded-lg p-2",children:[e.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[e.jsx(Y,{className:"h-3 w-3 text-blue-500"}),e.jsx("h3",{className:"font-medium text-xs",children:"Created"})]}),e.jsx("p",{className:"text-xs text-black font-medium",children:n&&v(n.createdAt)})]}),(n==null?void 0:n.publishDate)&&e.jsxs("div",{className:"bg-white border rounded-lg p-2",children:[e.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[e.jsx(f,{className:"h-3 w-3 text-green-500"}),e.jsx("h3",{className:"font-medium text-xs",children:"Published"})]}),e.jsx("p",{className:"text-xs text-black font-medium",children:v(n.publishDate)})]}),e.jsxs("div",{className:"bg-white border rounded-lg p-2",children:[e.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[e.jsx(ce,{className:"h-3 w-3 text-blue-500"}),e.jsx("h3",{className:"font-medium text-xs",children:"Slides"})]}),e.jsxs("p",{className:"text-xs text-black font-medium",children:[n==null?void 0:n.slideCount," slides"]})]}),(n==null?void 0:n.views)&&e.jsxs("div",{className:"bg-white border rounded-lg p-2",children:[e.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[e.jsx(f,{className:"h-3 w-3 text-blue-500"}),e.jsx("h3",{className:"font-medium text-xs",children:"Views"})]}),e.jsx("p",{className:"text-xs text-black font-medium",children:n.views.toLocaleString()})]})]}),e.jsxs(Pe,{className:"flex sm:justify-between",children:[e.jsxs("div",{className:"hidden sm:flex gap-2",children:[e.jsxs(i,{variant:"outline",size:"sm",className:"gap-1 text-xs h-7",onClick:()=>{n&&(navigator.clipboard.writeText(`${window.location.origin}/carousel/${n._id}`),c.success("Carousel link copied to clipboard"))},children:[e.jsx(Ae,{className:"h-3 w-3"}),"Share"]}),e.jsxs(i,{variant:"outline",size:"sm",className:"gap-1 text-xs h-7",onClick:()=>{n&&ye(n._id,n.title)},children:[e.jsx(I,{className:"h-3 w-3"}),"Download PDF"]})]}),e.jsx("div",{className:"flex gap-2 w-full sm:w-auto",children:e.jsxs(i,{className:"flex-1 sm:flex-auto text-xs h-7",onClick:()=>{n&&we(n)},children:[e.jsx(W,{className:"h-3 w-3 mr-1"}),"Create Post"]})})]})]})}),e.jsx(he,{open:!!a,onOpenChange:s=>{s||(S(null),$(!1),g({}),ve(null),re(!1))},children:e.jsx(ue,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:a&&e.jsxs(e.Fragment,{children:[e.jsxs(pe,{children:[e.jsxs(ge,{className:"flex justify-between items-center",children:[p?e.jsx(V,{value:m.title||a.title,onChange:s=>g({...m,title:s.target.value}),className:"font-bold text-lg"}):e.jsx("span",{children:a.title}),e.jsx(M,{status:a.status})]}),e.jsxs(Ue,{children:["Requested on ",v(a.createdAt),a.updatedAt&&a.updatedAt!==a.createdAt&&` • Last updated on ${v(a.updatedAt)}`,a.resendCount&&a.resendCount>0&&` • Resent ${a.resendCount} time${a.resendCount>1?"s":""}`]})]}),a.status==="completed"&&a.completedFiles&&a.completedFiles.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Completed Files"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:a.completedFiles.map((s,l)=>e.jsxs("div",{className:"border rounded p-4 flex flex-col",children:[e.jsxs("div",{className:"flex items-center mb-3",children:[s&&s.url&&j(s.url)?e.jsx(z,{className:"h-5 w-5 mr-2 text-blue-500"}):e.jsx(T,{className:"h-5 w-5 mr-2 text-orange-500"}),e.jsx("span",{className:"text-sm font-medium truncate",children:(s==null?void 0:s.originalName)||w(s==null?void 0:s.url)})]}),s&&s.url&&j(s.url)&&e.jsx("div",{className:"mb-3 bg-gray-100 rounded p-1",children:e.jsx("img",{src:U(s.url),alt:s.originalName||"Preview",className:"max-h-40 mx-auto object-contain"})}),e.jsxs("div",{className:"flex justify-end mt-auto gap-2",children:[e.jsx(i,{variant:"ghost",size:"icon",onClick:()=>Fe(s),className:"h-8 w-8 rounded-full text-blue-600 hover:text-blue-800 hover:bg-blue-50",title:"View File",children:e.jsx(f,{className:"h-4 w-4"})}),s&&s.url&&e.jsx(i,{variant:"ghost",size:"icon",onClick:()=>G(U(s.url),s.originalName||w(s.url)),className:"h-8 w-8 rounded-full text-green-600 hover:text-green-800 hover:bg-green-50",title:"Download File",children:e.jsx(I,{className:"h-4 w-4"})})]})]},l))})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Description"}),p?e.jsx(Re,{value:m.description||a.description||"",onChange:s=>g({...m,description:s.target.value}),className:"min-h-[120px]"}):e.jsx("p",{className:"text-gray-700 bg-gray-50 p-3 rounded-md",children:a.description||"No description provided"})]}),(a.videoId||p)&&e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold mb-2",children:["YouTube Video ",p&&e.jsx("span",{className:"text-xs text-gray-500",children:"(Optional)"})]}),p?e.jsxs("div",{className:"space-y-3 bg-gray-50 p-3 rounded-md",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",htmlFor:"videoTitle",children:"Video Title"}),e.jsx(V,{id:"videoTitle",value:m.videoTitle||a.videoTitle||"",onChange:s=>g({...m,videoTitle:s.target.value}),placeholder:"Enter video title"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",htmlFor:"videoId",children:"YouTube Video ID"}),e.jsx(V,{id:"videoId",value:m.videoId||a.videoId||"",onChange:s=>g({...m,videoId:s.target.value}),placeholder:"e.g. dQw4w9WgXcQ"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",htmlFor:"youtubeUrl",children:"YouTube URL"}),e.jsx(V,{id:"youtubeUrl",value:m.youtubeUrl||a.youtubeUrl||"",onChange:s=>g({...m,youtubeUrl:s.target.value}),placeholder:"https://www.youtube.com/watch?v=..."})]}),(m.videoId||a.videoId)&&e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-xs text-blue-600 mb-2",children:"Preview:"}),e.jsx("div",{className:"aspect-video w-full max-w-md mx-auto overflow-hidden rounded-md",children:e.jsx("iframe",{width:"100%",height:"100%",src:`https://www.youtube.com/embed/${m.videoId||a.videoId}`,title:m.videoTitle||a.videoTitle||"YouTube Video",frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,className:"w-full h-full"})})]})]}):e.jsxs("div",{className:"bg-gray-50 p-3 rounded-md",children:[e.jsx("p",{className:"font-medium",children:a.videoTitle||"Untitled Video"}),a.youtubeUrl&&e.jsxs("div",{className:"mt-2 flex flex-col",children:[e.jsx("div",{className:"aspect-video w-full max-w-md mx-auto overflow-hidden rounded-md",children:e.jsx("iframe",{width:"100%",height:"100%",src:`https://www.youtube.com/embed/${a.videoId}`,title:a.videoTitle||"YouTube Video",frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,className:"w-full h-full"})}),e.jsxs("a",{href:a.youtubeUrl,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 mt-2 text-sm flex items-center self-start",children:[e.jsxs("svg",{className:"w-4 h-4 mr-1",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("path",{d:"M10 12a2 2 0 100-4 2 2 0 000 4z"}),e.jsx("path",{fillRule:"evenodd",d:"M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z",clipRule:"evenodd"})]}),"Open in YouTube"]})]})]})]}),(a.content||p)&&e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold mb-2",children:["Generated Content ",p&&e.jsx("span",{className:"text-xs text-gray-500",children:"(Optional)"})]}),p?e.jsx(Re,{value:m.content||a.content||"",onChange:s=>g({...m,content:s.target.value}),placeholder:"Enter carousel content here...",className:"min-h-[200px] font-mono text-sm"}):e.jsx("div",{className:"bg-gray-50 p-3 rounded-md whitespace-pre-wrap text-sm max-h-[200px] overflow-y-auto border border-gray-200",children:a.content}),!p&&a.content&&e.jsxs(i,{variant:"outline",size:"sm",className:"mt-2 text-xs",onClick:()=>{navigator.clipboard.writeText(a.content||""),c.success("Content copied to clipboard")},children:[e.jsx("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),"Copy Content"]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Carousel Type"}),p?e.jsxs(De,{value:m.carouselType||a.carouselType,onValueChange:s=>g({...m,carouselType:s}),children:[e.jsx(qe,{className:"w-full",children:e.jsx(es,{placeholder:"Select carousel type"})}),e.jsxs(ss,{children:[e.jsx(q,{value:"professional",children:"Professional"}),e.jsx(q,{value:"creative",children:"Creative"}),e.jsx(q,{value:"minimalist",children:"Minimalist"}),e.jsx(q,{value:"custom",children:"Custom"})]})]}):e.jsx("p",{className:"text-gray-700",children:e.jsx(R,{className:"bg-blue-100 text-blue-800 hover:bg-blue-200",children:a.carouselType})})]}),(a.status==="pending"||a.status==="in_progress"||a.status==="rejected")&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Files You Submitted"}),a.files&&a.files.length>0?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:a.files.map((s,l)=>e.jsxs("div",{className:"border rounded p-3 flex flex-col",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[j(s.url)?e.jsx(z,{className:"h-4 w-4 mr-2 text-blue-500"}):e.jsx(T,{className:"h-4 w-4 mr-2 text-orange-500"}),e.jsx("span",{className:"text-sm truncate font-medium",children:s.originalName||w(s.url)})]}),j(s.url)&&e.jsx("div",{className:"mb-2 bg-gray-100 rounded p-1",children:e.jsx("img",{src:U(s.url),alt:s.originalName||"Preview",className:"max-h-32 mx-auto object-contain"})}),e.jsx("div",{className:"flex justify-end mt-auto gap-2",children:e.jsx(i,{variant:"ghost",size:"icon",onClick:()=>Fe(s),className:"h-8 w-8 rounded-full text-blue-600 hover:text-blue-800 hover:bg-blue-50",title:"View File",children:e.jsx(f,{className:"h-4 w-4"})})})]},l))}):e.jsx("p",{className:"text-gray-500 italic",children:"No files were submitted with this request"})]}),p&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Add New Files"}),e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-md p-6 flex flex-col items-center justify-center",children:[e.jsx("input",{type:"file",id:"new-files",multiple:!0,className:"hidden",onChange:s=>{s.target.files&&s.target.files.length>0&&g({...m,newFiles:Array.from(s.target.files)})}}),m.newFiles&&m.newFiles.length>0?e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("p",{className:"text-sm font-medium",children:[m.newFiles.length," files selected"]}),e.jsx(i,{variant:"ghost",size:"sm",onClick:()=>{var s;return(s=document.getElementById("new-files"))==null?void 0:s.click()},children:"Change Files"})]}),e.jsx("div",{className:"space-y-2 max-h-32 overflow-y-auto",children:Array.from(m.newFiles).map((s,l)=>e.jsxs("div",{className:"flex items-center p-2 bg-gray-50 rounded",children:[s.type.startsWith("image/")?e.jsx(z,{className:"h-4 w-4 mr-2 text-blue-500"}):e.jsx(T,{className:"h-4 w-4 mr-2 text-orange-500"}),e.jsxs("div",{className:"flex-1 truncate",children:[e.jsx("p",{className:"text-sm truncate",children:s.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:[s.type||"Unknown type"," • ",(s.size/1024).toFixed(1)," KB"]})]}),e.jsx(i,{variant:"ghost",size:"sm",onClick:()=>{var t;const r=(t=m.newFiles)==null?void 0:t.filter((d,o)=>o!==l);g({...m,newFiles:r})},children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},l))})]}):e.jsxs("div",{className:"text-center",children:[e.jsx(je,{className:"h-10 w-10 text-gray-400 mx-auto mb-3"}),e.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Drag and drop files, or"}),e.jsx(i,{variant:"outline",onClick:()=>{var s;return(s=document.getElementById("new-files"))==null?void 0:s.click()},className:"mt-2",children:"Select Files"})]})]})]})]}),e.jsxs(Pe,{className:"gap-2 flex flex-wrap justify-end",children:[a.status==="rejected"&&!p&&e.jsxs(e.Fragment,{children:[e.jsxs(i,{className:"text-blue-600 border-blue-300 hover:bg-blue-50 hover:text-blue-700",variant:"outline",onClick:()=>$(!0),children:[e.jsx(W,{className:"h-4 w-4 mr-2"}),"Edit & Resend"]}),e.jsx(i,{className:"text-blue-600 border-blue-300 hover:bg-blue-50 hover:text-blue-700",variant:"outline",onClick:()=>ke(a._id||a.id),disabled:a.resendCount&&a.resendCount>=1||ae,children:ae?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"animate-spin mr-1",children:"◔"}),"Processing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(je,{className:"h-4 w-4 mr-1"}),"Resend"]})})]}),p&&e.jsxs(e.Fragment,{children:[e.jsxs(i,{className:"text-green-600 border-green-300 hover:bg-green-50 hover:text-green-700",variant:"outline",onClick:()=>ke(a._id||a.id,m),children:[e.jsx(je,{className:"h-4 w-4 mr-1"}),"Save & Resend"]}),e.jsx(i,{variant:"outline",onClick:()=>{$(!1),g({})},children:"Cancel Edits"})]}),a.status==="completed"&&a.completedFiles&&a.completedFiles.length>0&&e.jsxs(i,{className:"text-green-600 border-green-300 hover:bg-green-50 hover:text-green-700",variant:"outline",onClick:()=>{Ce(a),S(null)},children:[e.jsx(I,{className:"h-4 w-4 mr-1"}),"Download All"]}),e.jsx(i,{variant:"outline",onClick:()=>{S(null),$(!1),g({})},children:"Close"})]})]})})}),e.jsx(he,{open:ze,onOpenChange:re,children:e.jsxs(ue,{className:"max-w-4xl max-h-[80vh] w-[90vw]",children:[e.jsx(pe,{children:e.jsxs(ge,{className:"flex justify-between items-center",children:[e.jsx("span",{children:x==null?void 0:x.name}),(x==null?void 0:x.url)&&e.jsxs(i,{variant:"outline",size:"sm",onClick:()=>{x!=null&&x.url&&G(x.url,x.name||"file")},children:[e.jsx(I,{className:"h-4 w-4 mr-2"}),"Download"]})]})}),e.jsx("div",{className:"relative w-full h-[60vh] bg-gray-50 rounded-lg overflow-hidden",children:(x==null?void 0:x.url)&&(x.type==="image"?e.jsx("img",{src:x.url,alt:x.name||"Image preview",className:"w-full h-full object-contain"}):e.jsx("iframe",{src:x.url,title:x.name||"Document preview",className:"w-full h-full border-0"}))})]})})]})};export{xs as default};
