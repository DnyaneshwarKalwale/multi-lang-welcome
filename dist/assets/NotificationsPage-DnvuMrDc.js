import{j as e}from"./ui-vendor-yLFRes2f.js";import{r as i}from"./react-vendor-DWSrZqKN.js";import{b9 as V,a7 as Y,N as B,X as F,a3 as H,a4 as W,a5 as z,b as x,ba as _,bb as j,bc as $,bd as X,be as q,bf as C,aH as J,G as S,j as K,aG as Q,b1 as Z,Y as ee,a0 as ae,a1 as se,a2 as le}from"./index-BbVnkZPX.js";import{A as te,m as re}from"./utils-vendor-DFcOAB1P.js";const k=[{id:"all",label:"All",color:"bg-gray-200"},{id:"welcome",label:"Welcome",color:"bg-green-200"},{id:"subscription",label:"Subscription",color:"bg-purple-200"},{id:"limit",label:"Usage Limits",color:"bg-amber-200"},{id:"carousel",label:"Carousel Updates",color:"bg-blue-200"},{id:"feature",label:"New Features",color:"bg-indigo-200"},{id:"offer",label:"Special Offers",color:"bg-pink-200"},{id:"general",label:"General",color:"bg-gray-200"}],A=({notification:s,onClick:r,onDelete:d,expanded:t=!1})=>{const l=k.find(o=>o.id===s.type)||k[k.length-1],g=s.read?"bg-blue-400":l.color,N=!t&&s.message.length>120?s.message.substring(0,120)+"...":s.message;return e.jsxs(re.div,{layout:!0,initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.2},className:S("flex flex-col gap-3 p-4 border rounded-lg transition-all cursor-pointer",s.read?"bg-white border-gray-100":"bg-blue-50 border-blue-100"),onClick:t?void 0:r,children:[!t&&s.imageUrl&&e.jsx("div",{className:"w-full h-24 mb-2 overflow-hidden rounded-md bg-gray-50 flex items-center justify-center",children:e.jsx("img",{src:s.imageUrl,alt:"Notification banner",className:"w-full h-full object-cover"})}),t&&s.imageUrl&&e.jsx("div",{className:"w-full mb-4 overflow-hidden rounded-md",children:e.jsx("img",{src:s.imageUrl,alt:"Notification banner",className:"w-full object-cover"})}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"flex-shrink-0 mt-1",children:e.jsx("div",{className:`w-3 h-3 rounded-full ${g}`})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.organizationLogo&&e.jsx("img",{src:s.organizationLogo,alt:"Organization logo",className:"w-5 h-5 rounded-full object-cover"}),e.jsx("h4",{className:"text-base font-medium text-gray-800",children:s.title})]}),s.organizationName&&e.jsx("div",{className:"flex items-center gap-1 mb-2",children:e.jsxs("span",{className:"text-xs text-gray-500",children:["From: ",s.organizationName]})}),e.jsx("p",{className:S("text-sm text-gray-600 mb-2",!t&&"line-clamp-2"),children:N}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs text-gray-400 block",children:s.timeAgo}),t&&s.link&&e.jsxs(x,{variant:"outline",size:"sm",className:"text-xs",onClick:o=>{o.stopPropagation(),window.open(s.link,"_blank")},children:[e.jsx(Q,{className:"h-3 w-3 mr-1"}),"View Details"]})]})]}),e.jsx("div",{className:"flex flex-col items-center gap-2",children:e.jsx("button",{onClick:o=>{o.stopPropagation(),d()},className:"text-gray-400 hover:text-red-400 transition-colors",children:e.jsx(Z,{className:"h-4 w-4"})})})]})]})},ie=({notification:s,open:r,onClose:d,onDelete:t,onRead:l})=>(i.useEffect(()=>{r&&s&&!s.read&&l()},[r,s]),s?e.jsx(ee,{open:r,onOpenChange:d,children:e.jsx(ae,{className:"sm:max-w-2xl bg-white p-0 overflow-hidden",children:e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsx(se,{className:"px-4 py-3 border-b border-gray-100",children:e.jsx(le,{className:"text-base font-medium text-gray-800",children:s.title})}),e.jsx("div",{className:"p-4 flex-1 overflow-auto",children:e.jsx(A,{notification:{...s,read:!0},onClick:()=>{},onDelete:t,expanded:!0})})]})})}):null),me=()=>{const{notifications:s,unreadCount:r,loading:d,error:t,pagination:l,fetchNotifications:g,markAsRead:N,markAllAsRead:o,deleteNotification:P}=V(),[h,T]=i.useState("all"),[c,L]=i.useState(""),[m,D]=i.useState(null),[M,p]=i.useState(!1),[U,R]=i.useState({});i.useEffect(()=>{g(1,l.limit)},[h]),i.useEffect(()=>{R({})},[s]);const E=()=>{const a=l.pages,n=l.page,u=[],b=5,f=Math.max(1,n-Math.floor(b/2)),G=Math.min(a,f+b-1);for(let v=f;v<=G;v++)u.push(v);return u},y=a=>{a>=1&&a<=l.pages&&g(a,l.limit)},O=a=>{D(a),p(!0)},I=a=>{N(a),R(n=>({...n,[a]:!0}))},w=s.filter(a=>{const n=U[a.id]||!1,u=a.read||n,b=h==="all"||!u,f=c===""||a.title.toLowerCase().includes(c.toLowerCase())||a.message.toLowerCase().includes(c.toLowerCase());return b&&f});return e.jsxs("div",{className:"container max-w-4xl mx-auto py-8 px-4 bg-white",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-2xl font-bold mb-2 text-gray-800",children:"Notifications"}),e.jsx("p",{className:"text-gray-500",children:"Stay updated with the latest information about your content, subscription, and more."})]}),e.jsxs("div",{className:"flex flex-col gap-4 mb-6",children:[e.jsxs("div",{className:"relative w-full",children:[e.jsx(Y,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(B,{placeholder:"Search notifications by title or content...",className:"pl-10 w-full bg-white border-gray-200",value:c,onChange:a=>L(a.target.value)}),c&&e.jsx("button",{onClick:()=>L(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-500",children:e.jsx(F,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-between items-start sm:items-center",children:[e.jsx(H,{value:h,onValueChange:a=>T(a),className:"w-full sm:w-auto",children:e.jsxs(W,{className:"grid grid-cols-2 w-full sm:w-[200px] bg-gray-100",children:[e.jsx(z,{value:"all",className:"text-gray-700 data-[state=active]:bg-white",children:"All"}),e.jsxs(z,{value:"unread",className:"text-gray-700 data-[state=active]:bg-white",children:["Unread",r>0&&e.jsx("span",{className:"ml-1 text-xs bg-red-400 text-white rounded-full w-4 h-4 inline-flex items-center justify-center",children:r})]})]})}),e.jsxs(x,{variant:"outline",size:"sm",onClick:o,disabled:r===0,className:"text-gray-600 border-gray-200 hover:bg-gray-50",children:[e.jsx(_,{className:"h-4 w-4 mr-2"}),"Mark all as read"]})]})]}),e.jsxs("div",{className:"space-y-4",children:[d?e.jsx("div",{className:"space-y-4",children:Array(3).fill(0).map((a,n)=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 flex gap-3 bg-white",children:[e.jsx(j,{className:"h-3 w-3 rounded-full bg-gray-200"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx(j,{className:"h-5 w-[40%] bg-gray-200"}),e.jsx(j,{className:"h-4 w-full bg-gray-200"}),e.jsx(j,{className:"h-3 w-[20%] bg-gray-200"})]})]},n))}):w.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx($,{className:"h-12 w-12 mb-3 text-gray-300"}),e.jsx("h3",{className:"text-lg font-medium mb-1 text-gray-700",children:"No notifications found"}),e.jsx("p",{className:"text-sm text-gray-500 max-w-md mb-6",children:c?`No notifications match your search for "${c}"`:h!=="all"?"You have no unread notifications.":"You don't have any notifications yet. We'll notify you about important updates."})]}):e.jsx(te,{children:e.jsx("div",{className:"space-y-4",children:w.map(a=>e.jsx(A,{notification:a,onClick:()=>O(a),onDelete:()=>P(a.id)},a.id))})}),!d&&w.length>0&&l.pages>1&&e.jsx(X,{className:"mt-8",children:e.jsxs(q,{children:[e.jsx(C,{children:e.jsx(x,{variant:"outline",size:"icon",className:"h-8 w-8 text-gray-500 border-gray-200",onClick:()=>y(l.page-1),disabled:l.page<=1,children:e.jsx(J,{className:"h-4 w-4"})})}),E().map(a=>e.jsx(C,{children:e.jsx(x,{variant:a===l.page?"default":"outline",size:"icon",className:S("h-8 w-8",a===l.page?"bg-blue-100 text-blue-700 border-blue-200 hover:bg-blue-100":"text-gray-600 border-gray-200"),onClick:()=>y(a),children:a})},a)),e.jsx(C,{children:e.jsx(x,{variant:"outline",size:"icon",className:"h-8 w-8 text-gray-500 border-gray-200",onClick:()=>y(l.page+1),disabled:l.page>=l.pages,children:e.jsx(K,{className:"h-4 w-4"})})})]})}),t&&e.jsx("div",{className:"mt-6 p-4 rounded-lg border border-red-100 bg-red-50 text-red-500 text-sm text-center",children:t})]}),e.jsx(ie,{notification:m,open:M,onClose:()=>p(!1),onDelete:()=>{m&&(P(m.id),p(!1))},onRead:()=>m&&I(m.id)})]})};export{me as default};
