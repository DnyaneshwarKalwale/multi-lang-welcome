import{j as e}from"./ui-vendor-yLFRes2f.js";import{r as n,u as Ye,d as Je,R as Ie}from"./react-vendor-DWSrZqKN.js";import{k as ce,W as Ke,Y as Ce,$ as Qe,b,I as pe,a0 as De,a1 as Le,a2 as Te,a3 as Ee,a4 as Oe,a5 as ke,o as Xe,a6 as fe,a7 as Ze,N as J,s as oe,a8 as es,e as ss,a9 as ts,aa as Ae,a as as,ab as ls,ac as is,ad as k,F as rs,V as ns,ae as os,c as a,af as cs,ag as ds,ah as ms,ai as us,aj as xe,ak as hs,al as xs,am as gs,an as ps,ao as ge,L as fs,ap as bs,aq as ae,ar as le,as as ie,at as re,au as ne,av as js,aw as Pe,g as ws,ax as vs,ay as ys,az as Ns,S as Ss,X as Is}from"./index-CqPKG3Vx.js";import{F as ze}from"./folder-DWkz83gx.js";import{l as P}from"./linkedinApi-DOmcQZXx.js";import{S as ks}from"./share-2-CeaL_0hT.js";import"./utils-vendor-DFcOAB1P.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ps=ce("ArrowRightFromLine",[["path",{d:"M3 5v14",key:"1nt18q"}],["path",{d:"M21 12H7",key:"13ipq5"}],["path",{d:"m15 18 6-6-6-6",key:"6tx3qv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cs=ce("ChartNoAxesColumnIncreasing",[["line",{x1:"12",x2:"12",y1:"20",y2:"10",key:"1vz5eb"}],["line",{x1:"18",x2:"18",y1:"20",y2:"4",key:"cun8e5"}],["line",{x1:"6",x2:"6",y1:"20",y2:"16",key:"hq0ia6"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ds=ce("Forward",[["polyline",{points:"15 17 20 12 15 7",key:"1w3sku"}],["path",{d:"M4 18v-2a4 4 0 0 1 4-4h12",key:"jmiej9"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ls=ce("WandSparkles",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]),Ts=({onSelectImage:A,triggerButton:be,defaultOpen:x=!1})=>{const[g,K]=n.useState(x),[z,m]=n.useState([]),[U,B]=n.useState([]),[_,M]=n.useState(""),[S,y]=n.useState(null),[T,$]=n.useState(!0),[q,o]=n.useState("gallery");n.useEffect(()=>{g&&Q()},[g]),n.useEffect(()=>{if(_.trim()==="")B(z);else{const c=_.toLowerCase(),E=z.filter(u=>u.title&&u.title.toLowerCase().includes(c)||u.tags&&u.tags.some(je=>je.toLowerCase().includes(c)));B(E)}},[_,z]);const Q=()=>{$(!0);try{const c=Ke();m(c),B(c)}catch(c){console.error("Error loading gallery images:",c)}finally{$(!1)}},R=c=>{y(c)},G=c=>{m(E=>[c,...E]),B(E=>[c,...E]),y(c),o("gallery")},V=()=>{S&&(A(S),K(!1))};return e.jsxs(Ce,{open:g,onOpenChange:K,children:[e.jsx(Qe,{asChild:!0,children:be||e.jsxs(b,{variant:"outline",className:"gap-2",children:[e.jsx(pe,{className:"h-4 w-4"}),"Select Image"]})}),e.jsxs(De,{className:"sm:max-w-[800px] max-h-[90vh]",children:[e.jsx(Le,{children:e.jsx(Te,{children:"Image Gallery"})}),e.jsxs(Ee,{defaultValue:"gallery",value:q,onValueChange:o,children:[e.jsxs(Oe,{className:"grid grid-cols-2 w-[300px] mb-4",children:[e.jsxs(ke,{value:"gallery",className:"gap-2",children:[e.jsx(ze,{className:"h-4 w-4"}),"Gallery"]}),e.jsxs(ke,{value:"upload",className:"gap-2",children:[e.jsx(Xe,{className:"h-4 w-4"}),"Upload"]})]}),e.jsxs(fe,{value:"gallery",className:"space-y-4",children:[e.jsx("div",{className:"flex items-center mb-4",children:e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Ze,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-gray-500"}),e.jsx(J,{placeholder:"Search images...",className:"pl-8",value:_,onChange:c=>M(c.target.value)})]})}),T?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(oe,{className:"h-8 w-8 animate-spin"})}):U.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(pe,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No images found"}),e.jsx("p",{className:"text-gray-500 max-w-md mx-auto mb-4",children:_?"Try a different search term or clear your search.":"Upload images or generate some with AI to get started."}),e.jsx(b,{onClick:()=>o("upload"),children:"Upload Image"})]}):e.jsx(es,{className:"h-[400px]",children:e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4",children:U.map(c=>e.jsxs("div",{className:`relative cursor-pointer rounded-md overflow-hidden border-2 ${(S==null?void 0:S.id)===c.id?"border-primary":"border-transparent"}`,onClick:()=>R(c),children:[e.jsxs("div",{className:"aspect-square relative bg-gray-50 dark:bg-gray-900",children:[e.jsx("img",{src:c.secure_url,alt:c.title||"Gallery image",className:"absolute inset-0 m-auto max-w-full max-h-full object-contain",style:{padding:"4px"}}),(S==null?void 0:S.id)===c.id&&e.jsx("div",{className:"absolute inset-0 bg-primary/20 flex items-center justify-center",children:e.jsx("div",{className:"bg-primary text-white rounded-full p-1",children:e.jsx(ss,{className:"h-5 w-5"})})})]}),e.jsx("div",{className:"p-1 text-xs truncate text-center",children:c.title||"Untitled"})]},c.id))})})]}),e.jsx(fe,{value:"upload",children:e.jsx("div",{className:"py-4",children:e.jsx(ts,{onUploadComplete:G,folder:"linkedin_gallery",tags:["linkedin","selected"]})})})]}),e.jsxs(Ae,{children:[e.jsx(b,{variant:"outline",onClick:()=>K(!1),children:"Cancel"}),e.jsx(b,{onClick:V,disabled:!S,children:"Select Image"})]})]})]})},Ws=()=>{var Se;const A=Ye(),x=Je().state,{user:g}=as(),{clearState:K}=ls(),{updatePostCounts:z}=is(),[m,U]=n.useState("");n.useEffect(()=>()=>{Object.keys(localStorage).forEach(s=>{(s.startsWith("state:createPost.")||s==="editingDraftId"||s==="editingScheduledId")&&localStorage.removeItem(s)}),Object.keys(sessionStorage).forEach(s=>{s.startsWith("createPost.")&&sessionStorage.removeItem(s)})},[]),n.useEffect(()=>{const s=()=>{Object.keys(localStorage).forEach(t=>{(t.startsWith("state:createPost.")||t==="editingDraftId"||t==="editingScheduledId")&&localStorage.removeItem(t)}),Object.keys(sessionStorage).forEach(t=>{t.startsWith("createPost.")&&sessionStorage.removeItem(t)})};return window.addEventListener("beforeunload",s),()=>window.removeEventListener("beforeunload",s)},[]);const[B,_]=n.useState(!0),[M,S]=n.useState("text"),[y,T]=n.useState([]),[$,q]=n.useState(""),[o,Q]=n.useState(null),[R,G]=n.useState("idle"),V=Ie.useRef(null),[c,E]=n.useState(!1);n.useEffect(()=>{const s=document.createElement("style");return s.innerHTML=`
      .preview-pulse {
        transition: all 0.3s ease;
        box-shadow: 0 0 0 2px rgba(var(--primary-rgb), 0.3);
      }
      @keyframes pulse {
        0% { box-shadow: 0 0 0 0 rgba(var(--primary-rgb), 0.4); }
        70% { box-shadow: 0 0 0 6px rgba(var(--primary-rgb), 0); }
        100% { box-shadow: 0 0 0 0 rgba(var(--primary-rgb), 0); }
      }
    `,document.head.appendChild(s),()=>{document.head.removeChild(s)}},[]),k("createPost.selectedTemplate",null),k("createPost.sliderType","basic");const[u,je]=k("createPost.slides",[{id:"1",content:"Slide 1: Introduction to your topic"},{id:"2",content:"Slide 2: Key point or insight #1"},{id:"3",content:"Slide 3: Key point or insight #2"}]),[we,ve]=k("createPost.aiGeneratedImage",null),[O,Es]=k("createPost.isPollActive",!1),[I,de]=k("createPost.pollOptions",["",""]),[ye,Me]=k("createPost.pollDuration",1);k("createPost.hasArticle",!1),k("createPost.articleUrl",""),k("createPost.articleTitle",""),k("createPost.articleDescription",""),k("createPost.documentFile",null),k("createPost.documentDescription","");const[X,L]=n.useState(!1),[Os,As]=n.useState("linkedin"),[C,He]=k("createPost.visibility","PUBLIC"),[Fe,Y]=n.useState(!1),[H,me]=n.useState(()=>new Date),[Z,ue]=n.useState(()=>{const s=new Date,t=String(s.getHours()).padStart(2,"0"),r=String(s.getMinutes()).padStart(2,"0");return`${t}:${r}`}),Ne=Ie.useRef(!1);n.useEffect(()=>{if(x&&!Ne.current){if(Ne.current=!0,x.content&&U(x.content),x.hashtags&&T(x.hashtags),x.image&&(ve(x.image),S("text")),x.scheduledDate)try{const s=new Date(x.scheduledDate);isNaN(s.getTime())||(me(s),console.log("Set scheduled date from location state:",s))}catch(s){console.error("Error parsing scheduled date from location state:",s)}x.scheduleTime&&(ue(x.scheduleTime),console.log("Set schedule time from location state:",x.scheduleTime))}},[x,U,T,ve,S]),n.useEffect(()=>{x!=null&&x.openScheduleDialog&&(console.log("Opening schedule dialog from location state"),Y(!1))},[x==null?void 0:x.openScheduleDialog]);const W=()=>{G("saving"),V.current&&window.clearTimeout(V.current),setTimeout(()=>{G("saved"),V.current=window.setTimeout(()=>{G("idle")},2e3)},500)},Ue=s=>{T(y.filter(t=>t!==s)),W()},_e=s=>{Q(s),s.type==="ai-generated"&&S("text"),setTimeout(()=>{const t=document.querySelector(".preview-section");t&&(t.classList.add("preview-pulse"),setTimeout(()=>t.classList.remove("preview-pulse"),500))},100),W(),a.success("Image selected for your post")},$e=()=>{I.length<4?(de([...I,""]),W()):a.error("Maximum 4 options allowed for LinkedIn polls")},We=s=>{if(I.length>2){const t=[...I];t.splice(s,1),de(t),W()}else a.error("Poll requires at least 2 options")},Be=(s,t)=>{const r=[...I];r[s]=t,de(r),W()},ee=()=>{const t="https://api.brandout.ai/api".replace("/api","");localStorage.setItem("redirectAfterAuth","/dashboard/post"),window.location.href=`${t}/api/auth/linkedin-direct`},qe=async()=>{var s,t,r,i,d,p,h,F;try{if(L(!0),!m.trim()){a.error("Please add some content to your post"),L(!1);return}if(!localStorage.getItem("linkedin-login-token")){a.error("LinkedIn authentication required. Please login with LinkedIn to post content."),L(!1),window.confirm("Would you like to connect your LinkedIn account now?")&&ee();return}let l,D=null;if(O&&I.filter(N=>N.trim()).length>=2){const N=I.filter(j=>j.trim());l=await P.createPollPost(m,N,ye),(s=l==null?void 0:l.data)!=null&&s.id&&(D=l.data.id),a.success("Poll published to LinkedIn successfully!")}else if(M==="carousel"&&u.length>0){console.log("Publishing LinkedIn carousel post with slides:",u);try{if(a.info("Preparing carousel for LinkedIn..."),u.every(j=>{var f;return(f=j.cloudinaryImage)==null?void 0:f.secure_url})){const j=u.map(f=>{var v;return{content:f.content,imageUrl:(v=f.cloudinaryImage)==null?void 0:v.secure_url,cloudinaryImage:f.cloudinaryImage}});if(typeof P.createCarouselPost=="function")a.info("Creating LinkedIn post with carousel content..."),l=await P.createCarouselPost(m,j,C),(r=l==null?void 0:l.data)!=null&&r.id&&(D=l.data.id),a.success("Carousel content published to LinkedIn! Due to LinkedIn API limitations, the post includes the first image with all slide text."),a.info("To create true carousel posts with multiple images, you need to post directly through the LinkedIn app.");else{const f=u[0].cloudinaryImage;if(!(f!=null&&f.secure_url)){a.error("First slide image URL is missing"),L(!1);return}const v=u.map(te=>te.content).join(`

`),se=`${m}

${v}`;l=await P.createCloudinaryImagePost(se,f.secure_url,f.original_filename||"carousel-image","Carousel slide 1",C),(i=l==null?void 0:l.data)!=null&&i.id&&(D=l.data.id),a.success("Carousel content published as a single post with the first image."),a.info("LinkedIn API limitations prevent creating true carousel posts with multiple images.")}console.log("LinkedIn carousel post response:",l)}else{a.warning("Some slides are missing images. Publishing as a document instead.");const j=u.map(v=>v.content).join(`

`),f=`${m}

${j}`;l=await P.createTextPost(f,C),(t=l==null?void 0:l.data)!=null&&t.id&&(D=l.data.id),a.success("Carousel content published as text successfully!")}}catch(N){console.error("Error publishing LinkedIn carousel post:",N);try{const j=u.map(v=>v.content).join(`

`),f=`${m}

${j}`;l=await P.createTextPost(f,C),(d=l==null?void 0:l.data)!=null&&d.id&&(D=l.data.id),a.success("Carousel content published as text successfully!")}catch(j){throw console.error("Even text fallback failed:",j),j}}}else if(o){if(console.log("Publishing LinkedIn post with image:",o),!o.secure_url){a.error("Image URL is missing"),L(!1);return}try{a.info("Uploading image to LinkedIn..."),l=await P.createCloudinaryImagePost(m,o.secure_url,o.original_filename||"image",o.original_filename||"Shared image",C),(p=l==null?void 0:l.data)!=null&&p.id&&(D=l.data.id),console.log("LinkedIn image post response:",l),a.success("Image post published to LinkedIn successfully!")}catch(N){if(console.error("Error publishing LinkedIn image post:",N),N.message&&N.message.includes("authentication expired")){a.error("Your LinkedIn authentication has expired. Please reconnect your account."),window.confirm("Would you like to reconnect your LinkedIn account now?")&&ee(),L(!1);return}N.response&&N.response.status===422?a.error("LinkedIn was unable to process the image. Publishing as text post instead."):a.error("Failed to publish image. Publishing as text post instead.");try{const j=o.secure_url,f=o.original_filename||"image",v=`${m}

${f}: ${j}`;l=await P.createTextPost(v,C),(h=l==null?void 0:l.data)!=null&&h.id&&(D=l.data.id),console.log("LinkedIn text post fallback response:",l),a.success("Post published to LinkedIn as text with image link.")}catch(j){throw console.error("Even text fallback failed:",j),j}}}else console.log("Publishing LinkedIn text post"),l=await P.createTextPost(m,C),(F=l==null?void 0:l.data)!=null&&F.id&&(D=l.data.id),console.log("LinkedIn text post response:",l),a.success("Post published to LinkedIn successfully!");if(l)try{const j={title:"Published Post",content:m,hashtags:y,mediaType:o?"image":M==="carousel"&&u.length>0&&u.some(v=>{var se,te;return((se=v.content)==null?void 0:se.trim().length)>0&&((te=v.cloudinaryImage)==null?void 0:te.secure_url)})?"carousel":"none",postImage:o,slides:u,isPollActive:O,pollOptions:I.filter(Boolean),status:"published",visibility:C,publishedTime:new Date().toISOString(),platformPostId:D},f=await P.createDBPost(j);console.log("Published post saved to database:",f),Object.keys(localStorage).forEach(v=>{v.startsWith("state:createPost.")&&localStorage.removeItem(v)}),z(),A("/dashboard/posts",{state:{newPost:!0,activeTab:"published",platformPostId:D}})}catch(N){console.error("Error saving published post to database:",N),A("/dashboard/posts",{state:{newPost:!0,activeTab:"published",platformPostId:D}})}}catch(w){if(console.error("Error publishing to LinkedIn:",w),w.message&&w.message.includes("authentication expired")){a.error("Your LinkedIn authentication has expired. Please reconnect your account."),window.confirm("Would you like to reconnect your LinkedIn account now?")&&ee();return}w.response?(console.error("LinkedIn API error response:",w.response.data),w.response.status===401?(a.error("Authentication failed. Your LinkedIn token may have expired."),window.confirm("Would you like to reconnect your LinkedIn account now?")&&ee()):w.response.status===403?a.error("Permission denied. You may not have proper LinkedIn permissions."):w.response.status===404?a.error("API endpoint not found. The backend service might be unavailable."):w.response.status===422?a.error("LinkedIn could not process your request. Please check your content and try again."):w.response.status>=500?a.error("LinkedIn server error. Please try again later."):a.error(`LinkedIn error: ${w.response.data.message||"Unknown error"}`)):w.request?a.error("No response from server. Check your internet connection."):a.error("Failed to publish: "+w.message)}finally{L(!1)}},Re=async()=>{var s;try{if(!m.trim()&&!o&&!u.length&&!O){a.error("Please add some content before saving as draft");return}E(!0);const t=localStorage.getItem("editingDraftId"),r={id:t||`draft_${Date.now()}`,title:"Draft Post",content:m,excerpt:m.substring(0,100)+"...",createdAt:t?localStorage.getItem("state:createPost.createdAt")||new Date().toISOString():new Date().toISOString(),updatedAt:new Date().toISOString(),slides:u.length>0?u:[],postImage:o,isPollActive:O,pollOptions:I.filter(Boolean),hashtags:y,visibility:C,provider:"linkedin",status:"draft",date:new Date().toLocaleDateString()};try{if(t)t.startsWith("draft_")||await P.updateDBPost(t,{...r,id:t}),localStorage.setItem(t,JSON.stringify(r));else{const i=await P.createDBPost({...r,status:"draft"});i!=null&&i.success&&((s=i==null?void 0:i.data)!=null&&s._id)&&(r.id=i.data._id),localStorage.setItem(r.id,JSON.stringify(r))}localStorage.removeItem("editingDraftId"),Object.keys(localStorage).forEach(i=>{i.startsWith("state:createPost.")&&localStorage.removeItem(i)}),a.success(t?"Draft updated successfully":"Draft saved successfully"),A("/dashboard/posts",{state:{newDraft:!t,updatedDraft:t,activeTab:"drafts"}}),z()}catch(i){console.error("Error saving draft:",i),localStorage.setItem(r.id,JSON.stringify(r)),a.warning("Draft saved locally only. Some features may be limited.")}}catch(t){console.error("Error saving draft:",t),a.error("Failed to save draft",{description:t.message||"Please try again later"})}finally{E(!1)}},Ge=async()=>{var s;try{if(!m.trim()&&!o&&!u.length&&!O){a.error("Please add some content before scheduling");return}if(L(!0),a.info("Preparing to schedule your post..."),!H||!Z){a.error("Please select both date and time for scheduling");return}const t=new Date(H),[r,i]=Z.split(":").map(Number);if(t.setHours(r,i,0,0),t<=new Date){a.error("Please select a future date and time");return}const d=localStorage.getItem("editingScheduledId"),p={id:d||`scheduled_${Date.now()}`,title:"Scheduled Post",content:m,hashtags:y,visibility:C,platform:"linkedin",status:"scheduled",scheduledTime:t.toISOString(),mediaType:o?"image":M==="carousel"?"carousel":"none",postImage:o,slides:u,isPollActive:O,pollOptions:I.filter(Boolean),createdAt:d?localStorage.getItem("state:createPost.createdAt")||new Date().toISOString():new Date().toISOString(),updatedAt:new Date().toISOString()};try{let h;d?(d.startsWith("scheduled_")||(h=await P.updateDBPost(d,{...p,id:d})),localStorage.setItem(d,JSON.stringify(p))):(h=await P.createDBPost({...p,status:"scheduled"}),h!=null&&h.success&&((s=h==null?void 0:h.data)!=null&&s._id)&&(p.id=h.data._id),localStorage.setItem(p.id,JSON.stringify(p))),localStorage.removeItem("editingScheduledId"),Object.keys(localStorage).forEach(F=>{F.startsWith("state:createPost.")&&localStorage.removeItem(F)}),a.success(d?"Post schedule updated successfully!":"Post scheduled successfully!"),A("/dashboard/posts",{state:{scheduled:!d,updatedScheduled:d,activeTab:"scheduled"}}),z()}catch(h){console.error("Error scheduling post:",h),localStorage.setItem(p.id,JSON.stringify(p)),a.warning("Post scheduled locally only. Some features may be limited.")}}catch(t){console.error("Error scheduling post:",t),a.error("Error scheduling post: "+((t==null?void 0:t.message)||"Unknown error"))}finally{L(!1),Y(!1)}},he=n.useCallback(()=>{console.log("Explicitly closing dialog"),Y(!1)},[]);n.useEffect(()=>{const s=!!localStorage.getItem("editingDraftId")||!!localStorage.getItem("editingScheduledId");return()=>{s||(localStorage.removeItem("editingDraftId"),localStorage.removeItem("editingScheduledId"))}},[m,u]);const Ve=()=>{if(!m.trim()&&M==="text"){a.error("Please add some content before scheduling");return}if(u.length===0&&M==="carousel"){a.error("Please add at least one slide before scheduling");return}Y(!0)};return e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-neutral-black",children:"Create LinkedIn Content"}),R!=="idle"&&e.jsx("span",{className:`text-xs px-2 py-1 rounded-full transition-colors ${R==="saving"?"bg-amber-100 text-amber-800":"bg-green-100 text-green-800"}`,children:R==="saving"?"Saving...":"Saved"})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap justify-end",children:[e.jsx(b,{variant:"outline",size:"sm",className:"gap-1 text-xs sm:text-sm",onClick:Re,disabled:c,children:c?e.jsxs(e.Fragment,{children:[e.jsx(oe,{size:16,className:"animate-spin"}),e.jsx("span",{className:"hidden xs:inline",children:"Saving..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(rs,{size:16}),e.jsx("span",{className:"hidden xs:inline",children:"Save Draft"})]})}),e.jsxs(b,{variant:"outline",size:"sm",className:"gap-1 bg-blue-50 hover:bg-blue-100 text-blue-600 border-blue-200 text-xs sm:text-sm",onClick:Ve,children:[e.jsx(ns,{size:16,className:"mr-1"}),e.jsx("span",{className:"hidden xs:inline",children:"Schedule"})]}),e.jsx(Ce,{open:Fe,onOpenChange:s=>{Y(s),s||(console.log("Dialog closed via onOpenChange"),he())},children:e.jsxs(De,{className:"sm:max-w-md w-[95vw] max-w-[95vw] overflow-y-auto",onPointerDownOutside:he,children:[e.jsxs(Le,{children:[e.jsx(Te,{children:"Schedule LinkedIn Post"}),e.jsx(os,{children:"Choose when you want this post to be published to LinkedIn"})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-1 block",children:"Date"}),e.jsx(J,{type:"date",value:H.toISOString().split("T")[0],onChange:s=>{if(s.target.value){const t=new Date(s.target.value),r=H.getHours(),i=H.getMinutes();if(t.setHours(r,i,0,0),!isNaN(t.getTime())){const d=new Date,p=new Date(d.getFullYear(),d.getMonth(),d.getDate());new Date(t.getFullYear(),t.getMonth(),t.getDate())>=p?(me(t),console.log("Date changed to:",t)):a.error("Please select today or a future date")}}},min:new Date().toISOString().split("T")[0]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-1 block",children:"Time"}),e.jsx(J,{type:"time",value:Z,onChange:s=>{ue(s.target.value);const[t,r]=s.target.value.split(":").map(Number),i=new Date(H);i.setHours(t,r,0,0);const d=new Date;if(i<=d&&i.getDate()===d.getDate()&&i.getMonth()===d.getMonth()&&i.getFullYear()===d.getFullYear()){const p=new Date;p.setMinutes(p.getMinutes()+15);const h=String(p.getHours()).padStart(2,"0"),F=String(p.getMinutes()).padStart(2,"0"),w=`${h}:${F}`;a.error(`Time must be in the future. Setting to ${w}`),ue(w),i.setHours(p.getHours(),p.getMinutes(),0,0)}me(i),console.log("Time changed to:",s.target.value,"Updated date:",i)}})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-1 block",children:"Visibility"}),e.jsxs(cs,{value:C,onValueChange:s=>He(s),children:[e.jsx(ds,{children:e.jsx(ms,{placeholder:"Select visibility"})}),e.jsxs(us,{children:[e.jsx(xe,{value:"PUBLIC",children:"Public - Anyone on LinkedIn"}),e.jsx(xe,{value:"CONNECTIONS",children:"Connections only"}),e.jsx(xe,{value:"LOGGED_IN",children:"LinkedIn users only"})]})]})]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("h4",{className:"text-sm font-medium mb-1",children:"Post Summary"}),e.jsxs("div",{className:"border rounded p-3 bg-white text-sm",children:[e.jsx("p",{className:"line-clamp-3",children:m||"No content yet"}),o&&e.jsxs("p",{className:"text-green-600 mt-1",children:["Image: ",o.secure_url.split("/").pop()]}),O&&e.jsxs("p",{className:"text-blue-600 mt-1",children:["Poll with ",I.filter(s=>s.trim()).length," options"]}),e.jsxs("p",{className:"text-blue-600 mt-1",children:["Scheduled for: ",H.toLocaleDateString()," at ",Z]})]})]})]}),e.jsxs(Ae,{className:"flex-col sm:flex-row gap-2",children:[e.jsx(b,{variant:"outline",onClick:he,children:"Cancel"}),e.jsx(b,{onClick:Ge,disabled:X,children:X?e.jsxs(e.Fragment,{children:[e.jsx(oe,{className:"mr-2 h-4 w-4 animate-spin"}),"Scheduling..."]}):e.jsxs(e.Fragment,{children:[e.jsx(hs,{className:"mr-2 h-4 w-4"}),"Schedule Post"]})})]})]})}),e.jsxs(xs,{children:[e.jsx(gs,{asChild:!0,children:e.jsx(b,{size:"sm",className:"bg-primary text-white gap-1 text-xs sm:text-sm",children:X?e.jsxs(e.Fragment,{children:[e.jsx(oe,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{className:"hidden xs:inline",children:"Publishing..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ps,{size:16}),e.jsx("span",{className:"hidden xs:inline",children:"Publish"})]})})}),e.jsxs(ps,{align:"end",children:[e.jsxs(ge,{onClick:qe,disabled:X,className:"gap-2 cursor-pointer",children:[e.jsx(fs,{size:16,className:"text-blue-600"}),"Publish to LinkedIn"]}),e.jsx(bs,{}),e.jsxs(ge,{onClick:()=>a.info("Twitter integration coming soon!"),className:"gap-2 cursor-pointer text-muted-foreground",children:[e.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",children:e.jsx("path",{d:"M14.258 10.152 23.176 0h-2.113l-7.747 8.813L7.133 0H0l9.352 13.328L0 23.973h2.113l8.176-9.309 6.531 9.309h7.133zm-2.895 3.293-.949-1.328L2.875 1.56h3.246l6.086 8.523.945 1.328 7.91 11.078h-3.246z"})}),"Publish to X (Twitter)"]}),e.jsxs(ge,{onClick:()=>a.info("Facebook integration coming soon!"),className:"gap-2 cursor-pointer text-muted-foreground",children:[e.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",fill:"#1877F2",children:e.jsx("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})}),"Publish to Facebook"]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx("div",{className:"-mt-3",children:e.jsxs(Ee,{defaultValue:"text",className:"w-full",onValueChange:S,children:[e.jsx(Oe,{className:"-mb-3"}),e.jsx(fe,{value:"text",className:"-mt-6",children:e.jsxs(ae,{className:"border-t-0",children:[e.jsxs(le,{className:"px-4 py-2 sm:px-6 sm:py-2",children:[e.jsx(ie,{className:"text-lg sm:text-xl",children:"Create LinkedIn Post"}),e.jsx(re,{className:"text-sm",children:"Write your post content to share with your network"})]}),e.jsx(ne,{className:"px-4 sm:px-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(js,{placeholder:"Share your insights, knowledge, or ask a question...",className:"min-h-[200px] resize-y",value:m,onChange:s=>{const t=s.target.value;U(t);const r=/#[^\s#]+/g,i=t.match(r);i&&i.map(h=>h.slice(1)).forEach(h=>{y.includes(h)||T([...y,h])});const d=document.querySelector(".preview-section");d&&(d.classList.add("preview-pulse"),setTimeout(()=>d.classList.remove("preview-pulse"),300)),W()}}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[y.map(s=>e.jsxs(Pe,{variant:"secondary",className:"cursor-pointer hover:bg-neutral-light px-2 py-1 flex items-center gap-1",children:["#",s,e.jsx("button",{className:"ml-1 text-xs hover:text-red-500",onClick:()=>Ue(s),children:"×"})]},s)),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(J,{placeholder:"Add hashtag",className:"w-32 h-8",value:$,onChange:s=>{q(s.target.value.replace("#",""))},onKeyDown:s=>{s.key==="Enter"&&(s.preventDefault(),$.split(/[\s#]+/).filter(Boolean).forEach(r=>{y.includes(r)||T([...y,r])}),q(""))}}),e.jsx(b,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:()=>{$.split(/[\s#]+/).filter(Boolean).forEach(t=>{y.includes(t)||T([...y,t])}),q("")},children:e.jsx(ws,{size:16})})]})]}),e.jsx("div",{className:"flex items-center gap-2 mb-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-md font-medium mb-2",children:"Post Image"}),o?e.jsxs("div",{className:"relative rounded-md overflow-hidden mb-2 border border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"bg-white flex items-center justify-center",style:{minHeight:"300px"},children:e.jsx("img",{src:o.secure_url,alt:"Post image",className:"max-w-full max-h-[350px] object-contain",style:{padding:"12px",display:"block",margin:"0 auto"}})}),e.jsx(b,{variant:"destructive",size:"sm",className:"absolute top-2 right-2",onClick:()=>Q(null),children:"Remove"})]}):e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsx(Ts,{onSelectImage:_e,triggerButton:e.jsxs(b,{variant:"outline",className:"w-full sm:w-auto gap-2",children:[e.jsx(pe,{className:"h-4 w-4"}),"Select from Gallery"]})}),e.jsxs(b,{variant:"outline",className:"w-full sm:w-auto gap-2",onClick:()=>A("/dashboard/images"),children:[e.jsx(ze,{className:"h-4 w-4"}),"Manage Images"]})]})]})})]})})]})})]})}),e.jsx("div",{children:e.jsxs(ae,{className:"border-primary/30 bg-white",children:[e.jsx(le,{className:"pb-2 bg-primary/5",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(ie,{className:"text-black text-lg",children:"Live Preview"}),e.jsx(re,{className:"text-gray-800",children:"Your post updates in real-time as you type"})]}),e.jsx(Pe,{variant:"outline",className:"bg-primary/10 text-primary",children:"Live"})]})}),e.jsx(ne,{className:"px-2 py-3 sm:px-4 sm:py-4 overflow-hidden",children:e.jsxs("div",{className:"rounded-lg border border-gray-200 p-3 sm:p-4 max-w-xl mx-auto preview-section bg-white shadow-md overflow-hidden",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-primary/90 flex items-center justify-center text-white font-bold ring-2 ring-white overflow-hidden",children:g!=null&&g.profilePicture?e.jsx("img",{src:g.profilePicture,alt:g.firstName,className:"w-full h-full object-cover"}):((Se=g==null?void 0:g.firstName)==null?void 0:Se.charAt(0))||"U"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-[15px] text-black",children:g?`${g.firstName} ${g.lastName}`:"User Name"}),e.jsxs("p",{className:"text-xs text-gray-800",children:[(g==null?void 0:g.role)||"LinkedIn User"," ",g!=null&&g.role?" · ":"",e.jsx("span",{className:"text-blue-600",children:"Follow"})]}),e.jsxs("div",{className:"flex items-center gap-1 text-[11px] text-gray-800 mt-0.5",children:[e.jsx("span",{children:"Now"}),e.jsx("span",{children:"•"}),e.jsx(vs,{className:"h-3 w-3"}),e.jsx("span",{className:"ml-auto text-[11px] text-gray-800",children:e.jsx("span",{className:"text-blue-600",children:"500+ connections"})})]})]})]}),e.jsxs("div",{className:"mb-4 transition-all duration-200",children:[e.jsx("p",{className:"text-[14px] leading-relaxed text-black whitespace-pre-line mb-3 transition-all duration-200 break-words",children:m||"Your post content will appear here"}),(o||we)&&e.jsx("div",{className:"mb-3 rounded-lg overflow-hidden transition-all duration-300 border border-gray-100",children:e.jsx("img",{src:o?o.secure_url:we,alt:"Post image",className:"w-full object-contain transition-all duration-200",style:{maxHeight:"300px",display:"block",margin:"0 auto"}})}),e.jsx("div",{className:"flex flex-wrap gap-1.5 mt-1",children:y.map(s=>e.jsx("span",{className:"text-blue-600 text-[13px] hover:underline cursor-pointer break-all",children:`#${s}`},s))})]}),e.jsxs("div",{className:"flex items-center gap-1 text-neutral-medium text-xs mb-1 pt-2",children:[e.jsxs("div",{className:"flex -space-x-1",children:[e.jsx("div",{className:"w-4 h-4 rounded-full bg-blue-500 flex items-center justify-center text-[8px] text-white",children:"👍"}),e.jsx("div",{className:"w-4 h-4 rounded-full bg-red-500 flex items-center justify-center text-[8px] text-white",children:"❤️"}),e.jsx("div",{className:"w-4 h-4 rounded-full bg-green-500 flex items-center justify-center text-[8px] text-white",children:"👏"})]}),e.jsx("span",{className:"text-xs",children:"John Doe and 24 others"})," • ",e.jsx("span",{className:"text-xs",children:"8 comments"})]}),e.jsx("div",{className:"border-t border-gray-200 pt-1 mt-1",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("button",{className:"flex flex-col items-center gap-1 hover:text-blue-600 transition-colors py-1 px-1 sm:px-3 rounded-md hover:bg-blue-50 flex-1",children:[e.jsx(ys,{size:16,className:"sm:h-[18px] sm:w-[18px]"}),e.jsx("span",{className:"text-[10px] sm:text-xs font-medium",children:"Like"})]}),e.jsxs("button",{className:"flex flex-col items-center gap-1 hover:text-green-600 transition-colors py-1 px-1 sm:px-3 rounded-md hover:bg-green-50 flex-1",children:[e.jsx(Ns,{size:16,className:"sm:h-[18px] sm:w-[18px]"}),e.jsx("span",{className:"text-[10px] sm:text-xs font-medium",children:"Comment"})]}),e.jsxs("button",{className:"flex flex-col items-center gap-1 hover:text-amber-600 transition-colors py-1 px-1 sm:px-3 rounded-md hover:bg-amber-50 flex-1",children:[e.jsx(ks,{size:16,className:"sm:h-[18px] sm:w-[18px]"}),e.jsx("span",{className:"text-[10px] sm:text-xs font-medium",children:"Share"})]}),e.jsxs("button",{className:"flex flex-col items-center gap-1 hover:text-purple-600 transition-colors py-1 px-1 sm:px-3 rounded-md hover:bg-purple-50 flex-1",children:[e.jsx(Ds,{size:16,className:"sm:h-[18px] sm:w-[18px]"}),e.jsx("span",{className:"text-[10px] sm:text-xs font-medium",children:"Send"})]})]})})]})})]})})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(ae,{className:"bg-white border-2",children:[e.jsxs(le,{children:[e.jsx(ie,{className:"text-black",children:"AI Tools"}),e.jsx(re,{className:"text-gray-800",children:"Enhance your content with AI"})]}),e.jsx(ne,{children:e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-medium mb-2 flex items-center gap-1 text-black",children:[e.jsx(Ss,{size:16,className:"text-amber-500"}),"AI Assistance"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(b,{size:"sm",variant:"outline",className:"w-full justify-start text-sm bg-white text-black truncate opacity-50 cursor-not-allowed",disabled:!0,children:[e.jsx(Ls,{className:"h-3.5 w-3.5 mr-2 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:"AI Writer (Coming Soon)"})]}),e.jsx(b,{size:"sm",variant:"outline",className:"w-full justify-start text-sm bg-white text-black truncate opacity-50 cursor-not-allowed",disabled:!0,children:e.jsx("span",{className:"truncate",children:"Generate Post (Coming Soon)"})}),e.jsx(b,{size:"sm",variant:"outline",className:"w-full justify-start text-sm bg-white text-black truncate opacity-50 cursor-not-allowed",disabled:!0,children:e.jsx("span",{className:"truncate",children:"Improve Writing (Coming Soon)"})}),e.jsx(b,{size:"sm",variant:"outline",className:"w-full justify-start text-sm bg-white text-black truncate opacity-50 cursor-not-allowed",disabled:!0,children:e.jsx("span",{className:"truncate",children:"Create Hook (Coming Soon)"})}),e.jsx(b,{size:"sm",variant:"outline",className:"w-full justify-start text-sm bg-white text-black truncate opacity-50 cursor-not-allowed",disabled:!0,children:e.jsx("span",{className:"truncate",children:"Suggest Hashtags (Coming Soon)"})})]})]})})})]}),e.jsxs(ae,{className:"bg-white border-2",children:[e.jsxs(le,{children:[e.jsx(ie,{className:"text-black",children:"Templates & Tips"}),e.jsx(re,{className:"text-gray-800",children:"Content templates and best practices"})]}),e.jsx(ne,{children:e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-medium mb-2 flex items-center gap-1 text-black",children:[e.jsx(Cs,{size:16,className:"text-accent"}),"Engagement Tips"]}),e.jsx("div",{className:"bg-white border-2 rounded-lg p-3 text-sm",children:e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-black",children:[e.jsx("li",{children:"Ask a question to encourage comments"}),e.jsx("li",{children:"Use 3-5 relevant hashtags"}),e.jsx("li",{children:"Keep paragraphs short and scannable"}),e.jsx("li",{children:"Include a clear call-to-action"})]})})]})})})]})]}),O&&e.jsxs("div",{className:"mt-4 p-4 bg-white border-2 rounded-md",children:[e.jsx("h3",{className:"text-sm font-medium mb-3 text-black",children:"Poll Options"}),e.jsxs("div",{className:"space-y-3",children:[I.map((s,t)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1",children:e.jsx(J,{placeholder:`Option ${t+1}`,value:s,onChange:r=>Be(t,r.target.value),className:"bg-white text-black"})}),I.length>2&&e.jsx(b,{variant:"ghost",size:"icon",onClick:()=>We(t),children:e.jsx(Is,{size:14})})]},t)),I.length<4&&e.jsx(b,{variant:"outline",size:"sm",onClick:$e,className:"w-full bg-white text-black",children:"Add Option"}),e.jsxs("div",{className:"mt-3",children:[e.jsx("label",{className:"block text-sm mb-1 text-black",children:"Poll Duration"}),e.jsxs("select",{className:"w-full p-2 border border-gray-300 rounded bg-white text-black",value:ye,onChange:s=>Me(parseInt(s.target.value)),children:[e.jsx("option",{value:1,children:"1 day"}),e.jsx("option",{value:3,children:"3 days"}),e.jsx("option",{value:7,children:"1 week"}),e.jsx("option",{value:14,children:"2 weeks"})]})]})]})]})]})};export{Ws as default};
