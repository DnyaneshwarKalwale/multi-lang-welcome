import{j as e}from"./ui-vendor-yLFRes2f.js";import{u as V,r as c}from"./react-vendor-DWSrZqKN.js";import{k as T,a as Q,bo as W,c as m,bp as H,aq as J,ar as Y,as as K,at as X,a7 as Z,N as ee,b as i,a3 as se,au as ae,a4 as te,a5 as N,s as L,bq as re,b1 as v,a6 as w,I as le,P as ie,g as de,D as ce,aF as ne,W as oe,br as _}from"./index-PhhDpJrj.js";import"./utils-vendor-DFcOAB1P.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=T("Grid2x2",[["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"M3 12h18",key:"1i2n21"}],["rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",key:"h1oib"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=T("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]),je=()=>{const I=V(),{user:d}=Q(),[n,P]=c.useState(""),[y,g]=c.useState(!0),[r,u]=c.useState(new Set),[h,k]=c.useState("grid"),[f,$]=c.useState("small"),[b,M]=c.useState("all"),[o,p]=c.useState([]),[U,C]=c.useState(!1);c.useEffect(()=>{(async()=>{g(!0);try{const t=oe();if(t.length>0){const a=t.map(l=>({id:l.id||l.public_id,userId:(d==null?void 0:d.id)||"guest",url:l.url,secure_url:l.secure_url,public_id:l.public_id,prompt:l.title,title:l.title||"Untitled",tags:l.tags||[],createdAt:l.uploadedAt||new Date().toISOString(),type:l.type,width:l.width||800,height:l.height||600}));p(a)}}catch(t){console.error("Error loading gallery images:",t),m.error("Failed to load images")}finally{g(!1)}})()},[d==null?void 0:d.id]);const x=o.filter(s=>{var l,j,D;const t=n===""||((l=s.title)==null?void 0:l.toLowerCase().includes(n.toLowerCase()))||((j=s.prompt)==null?void 0:j.toLowerCase().includes(n.toLowerCase()))||((D=s.tags)==null?void 0:D.some(R=>R.toLowerCase().includes(n.toLowerCase()))),a=b==="all"||s.type===b;return t&&a}),E=c.useCallback(async s=>{if(s.length!==0){C(!0);try{for(const t of s){const a=await W(t,{title:t.name.split(".")[0],tags:["uploaded"],type:"uploaded"}),l={id:a.id,userId:(d==null?void 0:d.id)||"guest",url:a.url,secure_url:a.secure_url,public_id:a.public_id,title:a.title||t.name.split(".")[0],tags:a.tags||["uploaded"],createdAt:a.uploadedAt,type:"uploaded",width:a.width,height:a.height};p(j=>[l,...j])}m.success(`${s.length} image${s.length>1?"s":""} uploaded successfully`)}catch(t){console.error("Error uploading images:",t),m.error("Failed to upload images. Please try again.")}finally{C(!1)}}},[d==null?void 0:d.id]),{getRootProps:F,getInputProps:q,isDragActive:S}=H({onDrop:E,accept:{"image/*":[".png",".jpg",".jpeg",".gif",".webp"]},maxSize:5*1024*1024}),z=s=>{const t=new Set(r);t.has(s)?t.delete(s):t.add(s),u(t)},B=()=>{u(new Set)},O=async()=>{if(!(r.size===0||!window.confirm(`Are you sure you want to delete ${r.size} image${r.size>1?"s":""}?`))){g(!0);try{o.filter(a=>r.has(a.id)).forEach(a=>{_(a.public_id)}),p(o.filter(a=>!r.has(a.id))),u(new Set),m.success(`${r.size} image${r.size>1?"s":""} deleted`)}catch(t){console.error("Error deleting images:",t),m.error("Failed to delete images. Please try again.")}finally{g(!1)}}},G=s=>{I("/dashboard/post",{state:{image:s.secure_url}})},A=s=>{if(window.confirm("Are you sure you want to delete this image? This cannot be undone.")){const t=o.find(a=>a.id===s);if(!t)return;if(p(o.filter(a=>a.id!==s)),r.has(s)){const a=new Set(r);a.delete(s),u(a)}_(t.public_id),m({title:"Image deleted",description:"The image has been removed from your gallery."})}};return e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Image Gallery"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Manage your LinkedIn post images"})]}),e.jsx("div",{className:"grid grid-cols-1 gap-6",children:e.jsxs(J,{children:[e.jsxs(Y,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsxs("div",{children:[e.jsx(K,{children:"Your Images"}),e.jsx(X,{children:y?"Loading...":`${x.length} images available`})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Z,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-gray-500"}),e.jsx(ee,{placeholder:"Search images...",className:"pl-8 w-[200px]",value:n,onChange:s=>P(s.target.value)})]}),e.jsxs("div",{className:"flex items-center border rounded-md",children:[e.jsx(i,{variant:h==="grid"?"secondary":"ghost",size:"sm",onClick:()=>k("grid"),className:"h-8",children:e.jsx(he,{className:"h-4 w-4"})}),e.jsx(i,{variant:h==="list"?"secondary":"ghost",size:"sm",onClick:()=>k("list"),className:"h-8",children:e.jsx(me,{className:"h-4 w-4"})})]}),h==="grid"&&e.jsx(i,{variant:"outline",size:"sm",onClick:()=>$(f==="small"?"large":"small"),className:"h-8",children:f==="small"?"Larger":"Smaller"})]})]}),e.jsx(se,{defaultValue:"all",value:b,onValueChange:s=>M(s),children:e.jsxs(ae,{className:"pt-0",children:[e.jsxs(te,{className:"mb-4",children:[e.jsx(N,{value:"all",children:"All Images"}),e.jsx(N,{value:"ai-generated",children:"AI Generated"}),e.jsx(N,{value:"uploaded",children:"Uploaded"})]}),e.jsxs("div",{...F(),className:`mb-6 border-2 border-dashed rounded-lg p-6 text-center transition-colors ${S?"border-primary bg-primary/5":"border-gray-300 dark:border-gray-700"}`,children:[e.jsx("input",{...q()}),U?e.jsxs("div",{className:"py-4",children:[e.jsx(L,{className:"h-8 w-8 animate-spin text-primary mx-auto mb-2"}),e.jsx("p",{className:"text-sm",children:"Uploading images..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(re,{className:"h-10 w-10 text-gray-400 mx-auto mb-2"}),e.jsx("p",{className:"text-sm mb-1",children:S?"Drop the images here":"Drag & drop images here, or click to select files"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Supports: JPG, PNG, GIF, WEBP (up to 5MB)"})]})]}),r.size>0&&e.jsxs("div",{className:"mb-4 p-2 bg-gray-50 dark:bg-gray-800 rounded-md flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm",children:[r.size," image",r.size>1?"s":""," selected"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(i,{size:"sm",variant:"ghost",onClick:B,children:"Cancel"}),e.jsxs(i,{size:"sm",variant:"destructive",onClick:O,children:[e.jsx(v,{className:"h-4 w-4 mr-1"}),"Delete"]})]})]}),e.jsx(w,{value:"all",className:"mt-0",children:y?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(L,{className:"h-8 w-8 animate-spin"})}):x.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(le,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No images found"}),e.jsx("p",{className:"text-gray-500 max-w-md mx-auto mb-4",children:n?"Try a different search term or clear your search.":"Upload images or generate some with AI to get started."}),e.jsxs(i,{children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"Add Images"]})]}):h==="grid"?e.jsx("div",{className:`grid gap-4 ${f==="small"?"grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5":"grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4"}`,children:x.map(s=>e.jsxs("div",{className:`group relative overflow-hidden border border-border hover:border-primary transition-colors ${r.has(s.id)?"ring-2 ring-primary ring-offset-2":""} rounded-md`,children:[e.jsx("div",{className:`cursor-pointer ${h==="grid"?"aspect-square":"aspect-[16/9]"} bg-gray-50 dark:bg-gray-900 flex items-center justify-center`,onClick:()=>z(s.id),children:e.jsx("img",{src:s.secure_url,alt:s.title||"Gallery image",className:"max-w-full max-h-full object-contain",style:{padding:"12px"}})}),e.jsxs("div",{className:"p-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-medium text-sm truncate",children:s.title||"Untitled Image"}),e.jsxs("p",{className:"text-xs text-muted-foreground truncate mt-1",children:[new Date(s.createdAt).toLocaleDateString()," · ",s.type]})]}),e.jsxs("div",{className:"flex gap-1 mt-1",children:[e.jsx(i,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>G(s),children:e.jsx(de,{className:"h-3.5 w-3.5"})}),e.jsx(i,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>window.open(s.secure_url,"_blank"),children:e.jsx(ce,{className:"h-3.5 w-3.5"})}),e.jsx(i,{variant:"ghost",size:"icon",className:"h-7 w-7 text-red-500 hover:text-red-600 hover:bg-red-50",onClick:t=>{t.stopPropagation(),A(s.id)},children:e.jsx(v,{className:"h-3.5 w-3.5"})})]})]}),s.tags&&s.tags.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-1 mt-2",children:[s.tags.slice(0,2).map((t,a)=>e.jsx("span",{className:"text-xs bg-gray-100 dark:bg-gray-800 px-1.5 py-0.5 rounded",children:t},a)),s.tags.length>2&&e.jsxs("span",{className:"text-xs bg-gray-100 dark:bg-gray-800 px-1.5 py-0.5 rounded",children:["+",s.tags.length-2]})]})]})]},s.id))}):e.jsx("div",{className:"space-y-3",children:x.map(s=>e.jsxs("div",{className:`flex items-center p-2 rounded-lg border ${r.has(s.id)?"bg-primary/5 border-primary":""}`,children:[e.jsx("div",{className:"flex-shrink-0 h-16 w-16 rounded-md overflow-hidden mr-4",children:e.jsx("img",{src:s.secure_url,alt:s.title||"Gallery image",className:"h-full w-full object-cover"})}),e.jsxs("div",{className:"flex-grow",children:[e.jsx("h4",{className:"font-medium text-sm",children:s.title||"Untitled"}),e.jsxs("p",{className:"text-xs text-gray-500",children:[new Date(s.createdAt).toLocaleDateString()," ·",s.type==="ai-generated"?" AI Generated":" Uploaded"]}),s.tags&&s.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:s.tags.map((t,a)=>e.jsx("span",{className:"text-xs px-1.5 py-0.5 bg-gray-100 dark:bg-gray-800 rounded-sm",children:t},a))})]}),e.jsxs("div",{className:"flex-shrink-0 flex items-center gap-2",children:[e.jsx(i,{variant:"outline",size:"sm",onClick:()=>G(s),children:"Use"}),e.jsx(i,{variant:r.has(s.id)?"secondary":"outline",size:"sm",onClick:()=>z(s.id),children:r.has(s.id)?"Selected":"Select"}),e.jsx(i,{variant:"outline",size:"sm",className:"text-red-500 hover:text-red-600 border-red-200 hover:border-red-300",onClick:()=>A(s.id),children:e.jsx(v,{className:"h-4 w-4"})})]})]},s.id))})}),e.jsx(w,{value:"ai-generated",className:"mt-0"}),e.jsx(w,{value:"uploaded",className:"mt-0"})]})}),e.jsxs(ne,{className:"flex justify-between border-t pt-4",children:[e.jsx("div",{className:"text-sm text-gray-500",children:!y&&e.jsxs(e.Fragment,{children:["Showing ",x.length," of ",o.length," images"]})}),e.jsx(i,{variant:"outline",size:"sm",onClick:()=>I("/dashboard/ai-writer"),children:"Generate More Images"})]})]})})]})};export{je as default};
